# Datagres Data Flow

direction: right

layers: {
  ui: {
    user: User {
      shape: person
      style.fill: "#E1E8ED"
    }
    
    components: UI Components {
      connection: ConnectionView
      explorer: ExplorerView
      table: TableView
      editor: SQL Editor
    }
  }

  frontend: {
    hooks: React Hooks {
      query: useQuery
      mutation: useMutation
      store: useAppSelector
    }
    
    store: Redux Store {
      connection: connectionSlice
      settings: settingsSlice
      ui: uiSlice
      tabs: tabsSlice
    }
    
    tanstack: TanStack Query {
      cache: Query Cache
      mutations: Mutations
    }
  }

  bridge: {
    api: Window API {
      shape: hexagon
      style.fill: "#FF6B6B"
    }
  }

  backend: {
    ipc: IPC Handlers {
      connect: db:connect
      fetch: db:fetch-table-data
      execute: db:execute-query
      save: connection:save
    }
    
    services: Services {
      db: databaseService
      conn: connectionStore
      menu: menuBuilder
    }
    
    security: Security Layer {
      keytar: OS Keychain
      store: electron-store
      style.fill: "#FFD700"
    }
  }

  external: {
    postgres: PostgreSQL {
      shape: cylinder
      style.fill: "#336791"
    }
    
    ssl: SSL/TLS {
      cloud: Cloud Providers
      shape: hexagon
      style.fill: "#4CAF50"
    }
  }
}

# Connections
ui.user -> ui.components
ui.components -> frontend.hooks: "User Actions"
frontend.hooks -> frontend.store: "Dispatch"
frontend.hooks -> frontend.tanstack: "Query/Mutate"
frontend.store -> bridge.api: "State Updates"
frontend.tanstack -> bridge.api: "API Calls"
bridge.api -> backend.ipc: "IPC Messages"
backend.ipc -> backend.services: "Handle"
backend.services -> backend.security: "Credentials"
backend.services -> external.postgres: "SQL"
external.ssl -> external.postgres: "Secure Connection"

# Styling
ui.components.style.fill: "#61DAFB"
frontend.store.style.fill: "#764ABC"
frontend.tanstack.style.fill: "#FF4154"
backend.ipc.style.fill: "#47848F"
backend.services.style.fill: "#2E86AB"